# PropManage - Hausverwaltungssoftware

*Property Management System built with Next.js, PostgreSQL (Prisma), and TypeScript*

## ğŸš€ Quick Start

### 1. First-Time Setup

**Navigate to the setup page and click "Start Setup":**
```
https://your-domain.com/setup
```

This will automatically:
- âœ… Create all database tables
- âœ… Enable Row Level Security
- âœ… Set up triggers and indexes
- âœ… Create admin user
- âœ… Seed demo data

### 2. Login

After setup completes, login with:
- **Email:** `admin@propmanage.de`
- **Password:** `RealCore2025`

### 3. Access the App

- **Admin Dashboard:** `/admin` - Manage properties, tenants, invoices
- **Tenant Portal:** `/portal` - View apartments, invoices, submit maintenance requests
- **Property Manager:** `/manager` - View assignments, complete tasks
- **Landing Page:** `/` - Public website with quote request form

## ğŸ—ï¸ Architecture

### Frontend Applications

1. **Admin Dashboard** (`/admin`)
   - Property & unit management
   - Tenant management
   - Invoice & payment tracking
   - Appointment scheduling
   - Maintenance request handling
   - Quote request management

2. **Tenant Portal** (`/portal`)
   - View apartment details
   - View & pay invoices
   - Submit maintenance requests
   - View contract information

3. **Property Manager App** (`/manager`)
   - Mobile-optimized interface
   - View assigned appointments
   - Complete maintenance tasks
   - Track work progress

4. **Landing Page** (`/`)
   - Modern, responsive design
   - Feature showcase
   - Quote request form
   - Contact information

### Backend Services

- **PostgreSQL** - Database hosted on Render.com
- **Prisma** - Type-safe ORM for database operations
- **Next.js Server Actions** - Server-side operations
- **JWT Authentication** - Secure session-based authentication

### Database Schema

- **profiles** - User information and roles
- **properties** - Building information
- **units** - Individual apartments/units
- **contracts** - Rental agreements
- **invoices** - Billing records
- **payments** - Payment tracking
- **appointments** - Scheduled tasks
- **maintenance_requests** - Tenant issue reporting
- **messages** - Internal communication
- **quote_requests** - New customer inquiries

## ğŸ› ï¸ Development

### Prerequisites

- Node.js 18+
- Render.com account (for deployment with PostgreSQL)

### Environment Variables

```env
# Database (automatically set by Render.com when using Blueprint)
DATABASE_URL=postgresql://user:password@host:5432/database

# Authentication
NEXTAUTH_SECRET=your-secret-key
NEXTAUTH_URL=https://your-app.onrender.com
```

### Local Development

```bash
# Install dependencies
npm install

# Generate Prisma client
npx prisma generate

# Set up local PostgreSQL database and run migrations
# First, set DATABASE_URL in .env file
npx prisma db push

# Run development server
npm run dev

# Navigate to setup page to seed demo data
open http://localhost:3000/setup
```

### Deployment on Render.com

1. **Fork/Push Repository to GitHub**

2. **Deploy via Blueprint:**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New" â†’ "Blueprint"
   - Connect your GitHub repository
   - Render will automatically detect `render.yaml`
   - This creates both the web service AND PostgreSQL database

3. **Configure Environment Variables:**
   - `DATABASE_URL` - Automatically set from linked database
   - `NEXTAUTH_SECRET` - Auto-generated by Render
   - `NEXTAUTH_URL` - Set to your Render app URL (e.g., `https://propmanage.onrender.com`)

4. **Deploy:**
   - Click "Manual Deploy" â†’ "Deploy latest commit"
   - Wait for build to complete (~3-5 minutes)
   - Prisma will automatically push the schema to the database

5. **Initial Setup:**
   - Navigate to `https://your-app.onrender.com/setup`
   - Click "Start Setup" to seed demo data

## ğŸ› Troubleshooting

### Setup Issues

If automatic setup fails:

1. **Check Database Connection:**
   - Verify `DATABASE_URL` is correctly set
   - Ensure PostgreSQL database is running and accessible

2. **Run Prisma Commands Manually:**
   ```bash
   npx prisma generate
   npx prisma db push
   ```

3. **Check Render Logs:**
   - Go to Render Dashboard â†’ Your Service â†’ Logs
   - Look for database connection errors

### Common Errors

- **"Cannot connect to database"** â†’ Check DATABASE_URL format and database availability
- **"Prisma client not generated"** â†’ Run `npx prisma generate`
- **Login fails** â†’ Ensure setup completed successfully and admin user was created

## ğŸ“š Documentation

- **SETUP_QUICK.md** - Detailed setup instructions
- **DEBUG_SQL.md** - SQL debugging guide
- **SETUP.md** - Manual setup procedures

## ğŸ”’ Security

- Row Level Security (RLS) enabled on all tables
- Role-based access control (Admin, Property Manager, Tenant, Employee)
- Secure password hashing via Supabase Auth
- API routes protected with authentication middleware

## ğŸ“ License

RealCore Group
